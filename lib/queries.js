// Generated by CoffeeScript 1.7.1
var fast_simple_query, frequency_query, knex, limit_query;

knex = require("knex").knex;

fast_simple_query = function(context) {
  return context.where(knex.raw("id in (select (random()*(select last_value from surnames_id_seq))::bigint from generate_series(1,120))"));
};

frequency_query = function(context, freq) {
  if (freq === "low") {
    return context.where("frequency", "<", 0.06);
  } else if (freq === "medium") {
    return context.where("frequency", ">=", 0.06).andWhere("frequency", "<", 1);
  } else if (freq === "high") {
    return context.where("frequency", ">=", 1);
  } else {
    return fast_simple_query(context);
  }
};

limit_query = function(limit) {
  if ((limit <= 100) && (limit >= 1)) {
    return limit;
  } else {
    return 10;
  }
};

module.exports.limit_query = limit_query;

module.exports.fast = fast_simple_query;

module.exports.frequency_query = frequency_query;
